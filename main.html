<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud-PC</title>
    <link rel="stylesheet" href="main-style.css">
</head>
<body>
    <div onmousedown="clicked_icon_field()" id="icon-field" class="icon-field">
        <div id="context-menu">
            <div class="item">New Folder</div>
            <div class="hr"></div>
            <div class="item">Get info</div>
            <div class="item">Change Background</div>
            <div class="hr"></div>
            <div class="item">Sort By</div>
            <div class="item">Copy</div>
            <div class="item">Paste</div>
            <div class="hr"></div>
            <div class="item">Create New File</div>
            <div class="item">Open in Terminal</div>
            <div class="item">Properties</div>
        </div>
        <div id="f1" ondblclick="dblclicked_icon(this)" onmouseup="clicked_icon(this)" class="icon-container">
            <div class="icon-img" style="background-image: url('image/icon/blue/user-home.ico')"></div>
            <input onclick="icon_text(this)" onkeypress="enter(event)" type="text" value="Home" disabled id="icon_text" class="icon-text">
        </div>
        <div id="f2" ondblclick="dblclicked_icon(this)" onmouseup="clicked_icon(this)" class="icon-container">
            <div class="icon-img" style="background-image: url('image/icon/blue/folder-documents.ico')"></div>
            <input onclick="icon_text(this)" onkeypress="enter(event)" type="text" value="Documents" id="icon_text" class="icon-text">
        </div>
        <div class="start-bar">
            <div class="start-menu"></div>
        </div>
    </div>
</body>


<script>
    var selected_id ="";
    function clicked_icon_field(){
        if(selected_id != ""){
            document.getElementById(selected_id).style = "background-color:none;";
            selected_id = "";
        }
    }
    function clicked_icon(e){
        id = e.id;
        document.getElementById(id).style="background-color:#5183ca93;";
        selected_id = id;
    }
    function icon_text(e){
        // id = e.id;
        // document.getElementById(id).ariaDisabled='True';
        // alert("clicked");
        // setTimeout(function run(){alert("hi")},1000);
        // document.getElementById(id).disabled="false";
    }
    function enter(event){
        if(event.keyCode === 13){
            id=event.target.id;
            document.getElementById(id).blur();
        }
    }
    document.addEventListener("dblclick",function(e){e.preventDefault()})

    // context-menu
    const contextMenu = document.getElementById("context-menu");
    const scope = document.querySelector("body");

    scope.addEventListener("contextmenu",(e) => {
        e.preventDefault();
        const {clientX: mouseX,clientY: mouseY} = e;
        contextMenu.style.left = `${mouseX}px`;
        contextMenu.style.top = `${mouseY}px`;
        if(window.innerWidth - mouseX < contextMenu.offsetWidth){
            contextMenu.style.left = `${window.innerWidth-contextMenu.offsetWidth}px`;
        }
        if(window.innerHeight - mouseY < contextMenu.offsetHeight){
            contextMenu.style.top = `${window.innerHeight-contextMenu.offsetHeight}px`;
        }
        
        setTimeout(() => {
            contextMenu.classList.add("visible");
        });
        scope.addEventListener("click",(e)=>{
            if(e.target.offsetParent != contextMenu){
                contextMenu.classList.remove("visible");
            }
        });
    });
    // context-menu ended
    document.addEventListener("click",(e) => {
        console.log(contextMenu.offsetWidth);
        console.log(contextMenu.offsetHeight);
    });
</script>
</html>